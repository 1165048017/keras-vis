<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>losses - Keras-vis Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../css/extras.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "losses";
    var mkdocs_page_input_path = "vis.losses.md";
    var mkdocs_page_url = "/vis.losses/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Keras-vis Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Visualizations</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../visualizations/conv_filters/">Convolutional Filters</a>
                </li>
                <li class="">
                    
    <a class="" href="../visualizations/dense/">Dense Layers</a>
                </li>
                <li class="">
                    
    <a class="" href="../visualizations/attention/">Attention Maps</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API Docs</span>
    <ul class="subnav">
                <li class=" current">
                    
    <span class="caption-text">Core API</span>
    <ul class="subnav">
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">losses</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#loss">Loss</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#loss__init__">Loss.__init__</a></li>
        
            <li><a class="toctree-l5" href="#lossbuild_loss">Loss.build_loss</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#activationmaximization">ActivationMaximization</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#activationmaximization__init__">ActivationMaximization.__init__</a></li>
        
            <li><a class="toctree-l5" href="#activationmaximizationbuild_loss">ActivationMaximization.build_loss</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#regressiontarget">RegressionTarget</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#regressiontarget__init__">RegressionTarget.__init__</a></li>
        
            <li><a class="toctree-l5" href="#regressiontargetbuild_loss">RegressionTarget.build_loss</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../vis.regularizers/">regularizers</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../vis.modifiers/">modifiers</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../vis.optimizer/">optimizer</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../vis.visualization/">visualization</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Utils</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../vis.utils.utils/">utils</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../vis.utils.vggnet/">vggnet</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Keras-vis Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>API Docs &raquo;</li>
        
      
        
          <li>Core API &raquo;</li>
        
      
    
    <li>losses</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="http://github.com/raghakot/keras-vis/blob/master/docs/templates/vis.losses.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><strong>Source:</strong> <a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L0">vis/losses.py#L0</a></p>
<hr />
<h2 id="loss"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L7">Loss</a></h2>
<p>Abstract class for defining the loss function to be minimized.
The loss function should be built by defining <code>build_loss</code> function.</p>
<p>The attribute <code>name</code> should be defined to identify loss function with verbose outputs.
Defaults to 'Unnamed Loss' if not overridden.</p>
<hr />
<h3 id="loss__init__"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L14">Loss.<code>__init__</code></a></h3>
<pre><code class="python">__init__(self)
</code></pre>

<hr />
<h3 id="lossbuild_loss"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L20">Loss.build_loss</a></h3>
<pre><code class="python">build_loss(self)
</code></pre>

<p>Implement this function to build the loss function expression.
Any additional arguments required to build this loss function may be passed in via <code>__init__</code>.</p>
<p>Ideally, the function expression must be compatible with all keras backends and <code>channels_first</code> or
<code>channels_last</code> image_data_format(s). <code>utils.slicer</code> can be used to define data format agnostic slices.
(just define it in <code>channels_first</code> format, it will automatically shuffle indices for tensorflow
which uses <code>channels_last</code> format).</p>
<pre><code class="python"># theano slice
conv_layer[:, filter_idx, ...]

# TF slice
conv_layer[..., filter_idx]

# Backend agnostic slice
conv_layer[utils.slicer[:, filter_idx, ...]]
</code></pre>

<p><a href="../vis.utils.utils/#get_img_shape">utils.get_img_shape</a> and
<a href="../vis.utils.utils/#get_img_indices">utils.get_img_indices</a> are other optional utilities that make this easier.</p>
<p><em>Returns:</em></p>
<p>The loss expression.</p>
<hr />
<h2 id="activationmaximization"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L49">ActivationMaximization</a></h2>
<p>A loss function that maximizes the activation of a set of filters within a particular layer.</p>
<p>Typically this loss is used to ask the reverse question - What kind of input image would increase the networks
confidence, for say, dog class. This helps determine what the network might be internalizing as being the 'dog'
image space.</p>
<p>One might also use this to generate an input image that maximizes both 'dog' and 'human' outputs on the final
<code>keras.layers.Dense</code> layer.</p>
<hr />
<h3 id="activationmaximization__init__"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L59">ActivationMaximization.<code>__init__</code></a></h3>
<pre><code class="python">__init__(self, layer, filter_indices)
</code></pre>

<p><em>Args:</em></p>
<ul>
<li><strong>layer</strong>:  The keras layer whose filters need to be maximized. This can either be a convolutional layer
  or a dense layer.</li>
<li><strong>filter_indices</strong>:  filter indices within the layer to be maximized.
  For <code>keras.layers.Dense</code> layer, <code>filter_idx</code> is interpreted as the output index.</li>
</ul>
<p>If you are optimizing final <code>keras.layers.Dense</code> layer to maximize class output, you tend to get
  better results with 'linear' activation as opposed to 'softmax'. This is because 'softmax'
  output can be maximized by minimizing scores for other classes.</p>
<hr />
<h3 id="activationmaximizationbuild_loss"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L76">ActivationMaximization.build_loss</a></h3>
<pre><code class="python">build_loss(self)
</code></pre>

<hr />
<h2 id="regressiontarget"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L94">RegressionTarget</a></h2>
<p>A loss function that drives regression outputs to targets.</p>
<p>Unlike classification, we cannot simply maximize the class output as it only serves to increase the regression
node output. We might want to visualize change in input that would cause the output to:</p>
<ul>
<li>Increase</li>
<li>Decrease</li>
<li>Remain the same</li>
</ul>
<p>For example, with self driving car steering angle output, we might want to see what causes it to turn more right
than predicted (increase output), more left (decrease output), or maintain its prediction (same).</p>
<hr />
<h3 id="regressiontarget__init__"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L107">RegressionTarget.<code>__init__</code></a></h3>
<pre><code class="python">__init__(self, layer, output_indices, targets, threshold=0.05)
</code></pre>

<p><em>Args:</em></p>
<ul>
<li><strong>layer</strong>:  The keras layer whose regression outputs needs to be visualized. This can be any layer with output
  of shape <code>(batch_size, outputs)</code>.</li>
<li><strong>output_indices</strong>:  Output indices within the layer.</li>
<li><strong>targets</strong>:  The desired regression output targets corresponding to <code>output_indices</code> outputs.
  To visualize input where output is same as the target, a value of <code>None</code> can be passed. This saves
  additional computation of predicting the actual output and then passing it as the target.</li>
<li><strong>threshold</strong>:  The threshold within which output should be considered the same as target.
  ie., |output - target| &lt; threshold means that regression output should not be changed.</li>
</ul>
<hr />
<h3 id="regressiontargetbuild_loss"><a href="https://github.com/raghakot/keras-vis/tree/master/vis/losses.py#L133">RegressionTarget.build_loss</a></h3>
<pre><code class="python">build_loss(self)
</code></pre>

<p>The rationale for this loss is as follows:</p>
<ul>
<li>
<p>When we consider the gradient of input pixel with respect to output, a positive gradient indicates the
direction that would cause the output to increase. Hence we try to increase the output when <code>target &gt; output</code>.</p>
</li>
<li>
<p>To decrease the value we need to consider negative gradients. So if we step in negative of that direction,
the output will decrease.</p>
</li>
<li>
<p>To maintain the same output, we want to focus on the gradients that are small. Hence we consider inverse of
output to highlight gradients that would be small.</p>
</li>
</ul>
<p>Basically, we want positive gradient to indicate the direction that achieves the increase, decrease or
remains same cases so that the optimization code can be uniform.</p>
<p><em>Returns:</em></p>
<p>The loss expression.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../vis.regularizers/" class="btn btn-neutral float-right" title="regularizers">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../visualizations/attention/" class="btn btn-neutral" title="Attention Maps"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="http://github.com/raghakot/keras-vis" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../visualizations/attention/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../vis.regularizers/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>
